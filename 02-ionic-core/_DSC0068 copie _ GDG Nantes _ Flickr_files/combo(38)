YUI.add("search-photos-lite-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return t.getPhotoLiteModels=!0,e.ListFetchers["flickr-photos-search"].run(t,this.appContext)}},attributes:{photos:{isCollection:!0,pageFetch:{fetchParams:{getPhotoLiteModels:!0},listFetcher:e.ListFetchers["flickr-photos-search"],listItemIdField:"photoId"}},totalItems:{setter:function(t){return(t=e.AttributeHelpers.coerceInteger(t))<0&&(t=0),t},defaultValue:0},apiParams:{writeOnce:"initOnly"},emptyQuery:{defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-search-fetcher","attribute-helpers"]});YUI.add("flickr-photos-search-fetcher",function(e,o){"use strict";var t=require("superagent"),r=require("hermes-core/flog")(o);e.namespace("ListFetchers")["flickr-photos-search"]={run:function(s,a){var p,i=this,l=s.emptyQuery?{}:this._processParams(e.merge({lang:a.lang||e.config.lang},s),a);if(l||(s.emptyQuery=!0),s.useV2API){var n=s.apiParams.tags||s.apiParams.text,h={orderBy:"interestingness",query:n,pageNumber:s.page-1>=0?s.page-1:0,pageSize:s.perPage,format:"json",nojsoncallback:1};s.minDateTaken&&s.maxDateTaken&&(s.apiParams.tags||s.apiParams.text)&&(h.query=e.SearchHelper.normalizeTag(n),h.context="tag:"+e.SearchHelper.normalizeTag(n)+" dateUploaded:["+s.minDateTaken+" TO "+s.maxDateTaken+"]"),p=[t.get("https://api.flickr.com/v2/media/search").use(require("hermes-core/req-id")).query(h).catch(function(e){return r.warn("API V2 Search returned a non valid response",{err:e}),{body:[],headers:{"x-total-count":0}}})]}else p=[s.emptyQuery?e.Promise.resolve({photos:{photo:[]}}):a.callAPI("flickr.photos.search",l)];return p=s.getPhotoLiteModels?p.concat([a.getModelRegistry("search-photos-lite-models"),a.getModelRegistry("photo-lite-models")]):p.concat([a.getModelRegistry("search-photos-models"),a.getModelRegistry("photo-models"),a.getModelRegistry("person-models"),a.getModelRegistry("photo-engagement-models"),a.getModelRegistry("photo-stats-models"),a.getModelRegistry("photo-geo-models")]),e.Promise.all(p).then(function(e){return i._processResponse(e,s)},e.FetcherErrorLogger(o))},_processParams:function(o,t){var r,s=e.merge(e.SearchHelper.UNIFIED_DEFAULT_PARAMS,{extras:e.APIHelper.request[o.getPhotoLiteModels?"getRebootPhotoLiteExtras":"getRebootPhotoExtras"](),per_page:o.perPage||50,page:o.page||"1",lang:o.lang});return o.fetchGeo&&(s.extras+=",geo"),o.additionalExtras&&(s.extras+=","+o.additionalExtras.join(",")),r=e.merge(s,o.apiParams||{}),o.privacyFilter&&(r.privacy_filter=o.privacyFilter),YUI.Env.isServer&&e.SearchHelper.unescapeParameters(r),e.SearchHelper.isParameterlessSearch(r)?null:r},_processResponse:function(o,t){var r,s,a,p,i,l,n=o[0],h=o[1],d=o[2],g={id:t.id||e.SearchUrl.EMPTY_SEARCH_ID,apiParams:{},emptyQuery:!!t.emptyQuery,photos:[]};if(t.id&&t.id!==e.SearchUrl.EMPTY_SEARCH_ID&&(g.apiParams=e.QueryString.parse(t.id)),!t.id)throw new ReferenceError("No `id` provided by request.");if(!(t.useV2API||n.photos&&n.photos.photo)){var c=new Error("No `photos.photo` property returned by search API v1.");throw c.fatal=!0,c}var u=t.useV2API?n.body:n.photos.photo;return t.getPhotoLiteModels?a=u.map(function(o){return i=e.APIHelper.response.parsePhotoLite(o),d.addOrUpdate(i)}):(a=e.APIHelper.response.parsePhotos({photos:n.photos.photo,photoModelRegistry:d,personModelRegistry:o[3],photoEngagementModelRegistry:o[4],photoStatsModelRegistry:o[5]}),t.fetchGeo&&(r=o[6],n.photos.photo.forEach(function(e){p=void 0!==e.latitude?{id:e.id,hasGeo:!0,latitude:e.latitude,longitude:e.longitude}:{id:e.id,hasGeo:!1},r.addOrUpdate(p)}))),g.photos={perPage:t.useV2API?t.perPage:n.photos.perpage,page:t.useV2API?t.page:n.photos.page,pageContent:a,totalItems:t.useV2API?n.headers["x-total-count"]:parseInt(n.photos.total,10),totalPages:t.useV2API?parseInt(n.headers["x-total-count"]/t.perPage,10):n.photos.pages/t.perPage},!t.useV2API&&n.photos.maxAllowedResults&&(g.photos.totalItems=Math.min(n.photos.maxAllowedResults,parseInt(n.photos.total,10))),!t.useV2API&&n.photos.maxAllowedPages&&(g.photos.totalPages=Math.min(n.photos.maxAllowedPages,n.photos.pages)),g.totalItems=t.useV2API?n.headers["x-total-count"]:parseInt(n.photos.total,10),h.exists(g.id)?(s=h.getValue(g.id,"photos").getList(),l=s.filter(function(e){return!!e}).reduce(function(e,o){return e[o.id]=!0,e},{}),g.photos.pageContent=g.photos.pageContent.filter(function(e){return!l[e.id]}),1===g.photos.page&&(g.photos.forceAppend=!0),h.addOrUpdate(g)):h.add(g),a}}},"@VERSION@",{requires:["flickr-promise","search-helper","search-url","api-helper","querystring-parse-simple"],optional:["search-photos-models","search-photos-lite-models","photo-models","photo-lite-models","person-models","photo-engagement-models","photo-stats-models","photo-geo-models"],optionalRequires:["superagent"]});YUI.add("search-photos-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-photos-search"].run(t,this.appContext)}},attributes:{photos:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-photos-search"],listItemIdField:"photoId"}},totalItems:{setter:function(t){return(t=e.AttributeHelpers.coerceInteger(t))<0&&(t=0),t},defaultValue:0},apiParams:{writeOnce:"initOnly"},emptyQuery:{defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-search-fetcher"]});YUI.add("photo-selector-limited-rows-photolist-view",function(e){e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return t.photolistViewClasses&&(t.additionalViewClasses=t.photolistViewClasses),t.photoListConfig=e.merge(t.primaryPhotoListConfig),this.searchUrl=t.searchUrl,this.listId=t.listId,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},subviewConfig:{"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){return this.appContext.getModel("search-photos-lite-models",this.searchUrl.getId(),{}).then(function(e){this.searchModel=e,e.getValue("totalItems")<=0&&this.set("emptySearch",!0)}.bind(this))},buildContainer:function(){var e="search.YOUR_PHOTOS";return"contacts"===this.listId?e="search.FROM_YOUR_CONTACTS":"everyone"===this.listId&&(e="search.EVERYONES_PHOTOS"),this.setContainerWithTemplate("search-photos-single-row",{emptySearch:this.get("emptySearch"),total:this.searchModel.getValue("totalItems"),singleResult:1===this.searchModel.getValue("totalItems"),viewAll:"#"+this.listId,"photo-list-view":this.subviews["photo-list-view"].get("container"),title:this.intlMessage({intlName:e})}),this},activate:function(){return this.registerEventHandler(this.get("container").on("click",this.handleClick.bind(this))),this},handleClick:function(e){e.halt();var t,i=e.target;i.hasClass("view-more-link")&&(t=i.getDOMNode().href.split("#")[1],this.fire("subviewViewEvent","viewEntireSearchList",{list:t,searchUrl:this.searchUrl}))}},{ATTRS:{emptySearch:{value:!1}}})},"@VERSION@",{requires:["flickr-view","photo-list-view","hermes-template-search-photos-single-row","search-photos-lite-models"],langBundles:["common","search"]});YUI.add("hermes-lang-search_fr-fr",function(e,r){e.Intl.add("hermes/search","fr-FR",{RELEVANT:["Pertinents"],RECENT:["Récents"],INTERESTING:["Intéressants"],NAME:["Nom"],ACTIVITY:["Activité"],SIZE:["Taille"],OLDEST:["Le plus ancien"],NEWEST:["Le plus récent"],DEFAULT_SEARCH:['C’est ici que vous faites des recherches dans Flickr. Voici une recherche de <span class="default-search">',"${query}","</span> pour commencer !"],FLICKR_SEARCH:["Recherche Flickr"],NO_MATCHES_FOR_QUERY_TERM:["Oups ! Aucun résultat pour « ","${searchTerm}"," »."],NO_MATCHES_FOR_QUERY_TERM_WITH_SETTINGS:["Oups ! Aucun résultat pour ","${searchTerm}"," correspondant aux paramètres sélectionnés."],NO_MATCHES_FOR_QUERY:["Oups ! Aucun résultat pour votre recherche."],TRY_DIFFERENT:["Veuillez préciser votre recherche."],TRY_DIFFERENT_BROADER:["Veuillez élargir votre recherche."],SEARCH_ERROR:["Oups ! La date que vous avez indiquée n’existe pas."],SEARCH_START:["Démarrez votre recherche"],SEARCHING:["Recherche"],FETCHING_PHOTOS:["Récupération d’autres photos..."],SEARCH:["Recherchez"],START_YOUR_SEARCH:["Démarrez votre recherche"],BY_USER:["par ","${user}"],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_YOUR:["Oups ! Aucun résultat pour « ","${searchTerm}"," » dans vos photos."],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_CONTACTS:["Oups ! Aucun résultat pour « ","${searchTerm}"," » dans les photos de vos contacts."],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_USER:["Oups ! Aucun résultat pour « ","${searchTerm}"," » dans les photos de cet utilisateur."],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_GROUP:["Oups ! Aucun résultat pour « ","${searchTerm}"," » dans ce groupe."],NO_MATCHES_FOR_QUERY_TERM_YOUR:["Oups ! Aucun résultat pour votre recherche dans vos photos."],NO_MATCHES_FOR_QUERY_TERM_CONTACTS:["Oops ! Aucun résultat pour votre recherche dans les photos de vos contacts."],NO_MATCHES_FOR_QUERY_TERM_USER:["Oups ! Aucun résultat pour votre recherche dans les photos de cet utilisateur."],NO_MATCHES_FOR_QUERY_TERM_GROUP:["Oups ! Aucun résultat pour votre recherche dans ce groupe."],API_ERROR_HEADER:["Oh non ! Nous n’avons pas pu traiter votre recherche."],API_ERROR_SUBHEADER:["Modifiez-la et réessayez."],PEOPLE_YOU_FOLLOW:["Personnes que vous suivez"],ALL_FLICKR_MEMBERS:["Tous les membres Flickr"],FLICKR_MEMBERS:["Membres Flickr"],YOUR_GROUPS:["Vos groupes"],ALL_FLICKR_GROUPS:["Tous les groupes Flickr"],FLICKR_GROUPS:["Groupes Flickr"],MEMBER_COUNT:[{type:"plural",valueName:"count",options:{zero:"0 membre",one:"${#} membre",other:"${#} membres"}}],GROUP_PHOTO_COUNT:[{type:"plural",valueName:"count",options:{zero:"aucune photo",one:"${#} photo",other:"${#} photos"}}],GROUP_DISCUSSION_COUNT:[{type:"plural",valueName:"count",options:{zero:"aucune discussion",one:"${#} discussion",other:"${#} discussions"}}],YOUR_PHOTOS:["Vos photos"],YOUR_ALBUMS:["Vos albums"],YOUR_GALLERIES:["Vos expos"],FROM_YOUR_CONTACTS:["De vos contacts"],EVERYONES_PHOTOS:["Photos de tout le monde"],VIEW_ALL_COUNT:[{type:"plural",valueName:"count",options:{zero:"plus de photos",other:"Voir les ${#}"}}],RESULTS_COUNT:[{type:"plural",valueName:"count",options:{zero:"aucun résultat",one:"${#} résultat",other:"${#} résultats"}}],PEOPLE_PHOTOS_COUNT:[{type:"plural",valueName:"count",options:{zero:"0 photo",one:"${#} photo",other:"${#} photos"}}],PEOPLE_VIDEOS_COUNT:[{type:"plural",valueName:"count",options:{zero:"aucune vidéo",one:"${#} vidéo",other:"${#} vidéos"}}],PEOPLE_FOLLOWERS_COUNT:[{type:"plural",valueName:"count",options:{zero:"aucun abonné",one:"${#} abonné",other:"${#} abonnés"}}],SAFESEARCH_ON:["SafeSearch activé"],SAFESEARCH_OFF:["SafeSearch désactivé"],SAFESEARCH_MODERATE:["SafeSearch modéré"],SEARCH_PHOTOSTREAM:["Rechercher dans la galerie"],SEARCH_FAVORITES:["Rechercher dans les favoris"],ANY_LICENSE:["Toute licence"],ALL_CC:["Tous les Creative Commons"],COMMERCIAL_USE:["Usage commercial autorisé"],MODS_ALLOWED:["Modifications autorisées"],COMMERCIAL_USE_MODS:["Usage commercial et modifications autorisés"],NO_RESTRICTIONS:["Aucune restriction de droits d’auteur connue"],MARKETPLACE_LICENSE:["Flickr Marketplace"],US_GOVT:["Travaux du gouvernement des États-Unis"],PUBLIC_DOMAIN_DEDICATION:["Droits de domaine public (CC0)"],PUBLIC_DOMAIN_WORK:["Œuvre du domaine public"],CC_BY_NC_SA:["Attribution-NonCommercial-ShareAlike"],CC_BY_NC:["Attribution-NonCommercial"],CC_BY_NC_ND:["Attribution-NonCommercial-NoDerivs"],CC_BY:["Attribution"],CC_BY_SA:["Attribution-ShareAlike"],CC_BY_ND:["Attribution-NoDerivs"],PLAIN_COUNT:[{type:"plural",valueName:"count",options:{zero:"0",one:"${#}",other:"${#}"}}],PHOTOS:["Photos"],PEOPLE:["Personnes"],GROUPS:["Groupes"],PHOTOS_POSSESSIVE:["Photos de ","${name}"],FAVES_POSSESSIVE:["Favoris de ","${name}"],CONTACTS_POSSESSIVE:["Contacts de ","${name}"],GROUPS_POSSESSIVE:["Groupes de ","${name}"],VIEWER_FAVES:["Vos favoris"],IN_GROUP_POOL:["Dans le pool du groupe ","${name}"],OPT_OUT_MESSAGE:["Vous voyez la version alpha de notre nouvelle expérience de recherche. Cliquez ici pour revenir à l’ancienne version."],OPT_IN_MESSAGE:["Revenir à l’expérience de recherche alpha"],OPT_OUT_MESSAGE_BETA:["Vous voyez la version bêta de notre nouvelle expérience de recherche. Cliquez ici pour revenir à l'ancienne version."],OPT_IN_MESSAGE_BETA:["Revenir à l'expérience de recherche bêta"],SEARCH_BETA_LABEL:["Recherche bêta"],SEARCH_ALPHA_LABEL:["Recherche alpha"],GO_BACK_TO_OLD_SEARCH:["Revenir à l'ancienne recherche Flickr"],PROVIDE_FEEDBACK:["Commenter"],FROM_PEOPLE_YOU_FOLLOW:["Parmi les personnes que vous suivez"],FULL_TEXT_AND_TAGS:["Texte intégral avec suggestion de tags"],FULL_TEXT:["Texte intégral"],TAGS_ONLY:["Tags uniquement"],RED:["Rouge"],DARK_ORANGE:["Orange foncé"],ORANGE:["Orange"],SCHOOL_BUS_YELLOW:["Jaune d'or"],LEMON_YELLOW:["Jaune citron"],GREEN:["Vert"],LIME_GREEN:["Vert épinard"],CYAN:["Cyan"],BLUE:["Bleu"],VIOLET:["Violet"],PINK:["Rose"],PALE_PINK:["Rose pâle"],WHITE:["Blanc"],GRAY:["Gris"],BLACK:["Noir"],MONOCHROME:["monochrome"],JOINED_DATE:["Date d'inscription : ",{type:"date",valueName:"intlDate",format:"monthYearShort"}],HIDE_INACTIVE_GROUPS:["Masquer les groupes inactifs"],ADVANCED:["Avancé"],ORIENTATION_AND_SIZE:["Orientation et taille"],ORIENTATION:["Orientation"],MINIMUM_SIZE:["Taille minimale"],PORTRAIT:["Portrait"],SQUARE:["Carré"],LANDSCAPE:["Paysage"],PANORAMA:["Panorama"],SMALL_SHOW_ALL_SIZES:["Petite (afficher tous les tailles)"],ALL_SIZES:["Toutes les tailles"],MEDIUM:["Taille moyenne"],LARGE:["Grande taille"],CUSTOM:["Personnalisé"],COLOR:["Couleur"],DATE:["Date"],FROM:["De"],TO:["À"],DATE_TAKEN:["Date de prise de vue"],DATE_POSTED:["Date de publication"],DATE_UPLOADED:["Date d'importation"],CONTENT:["Contenu"],VIDEOS:["Vidéos"],SCREENSHOTS:["Captures d’écran"],ILLUSTRATIONS:["Illustrations"],SEARCH_IN:["Rechercher dans"],RESET:["Réinitialiser"],JUSTIFIED_VIEW:["Affichage justifié"],THUMBNAIL_VIEW:["Affichage miniatures"],TILE_VIEW:["Affichage Vignettes"],SORT:["Trier"],TOGGLE_ADVANCED:["Bascule avancée"],CAMERA_SETTINGS:["Paramètres de l’appareil photo"],TOGGLE_SEARCH:["Passer à la recherche"],PHOTOS_PEOPLE_OR_GROUPS:["Photos, personnes, groupes"],PHOTOS_PEOPLE_GROUPS:["Photos, personnes, groupes"],SMALL_SHORT:["P"],MEDIUM_SHORT:["M"],LARGE_SHORT:["G"],ALL:["Tous"],TAGS:["Tags"],CLEAR:["Effacer"],ABSTRACT:["Abstrait"],ART:["Art"],BLACK_AND_WHITE:["Noir et blanc"],MONOCHROME_STYLE:["Monochrome"],BLUR:["Flou"],BRIGHT:["Brillant"],CURVES:["Courbes"],DIAGONAL:["Diagonale"],ETHEREAL:["Céleste"],GEOMETRIC:["Géométrique"],HDR:["Grande gamme dynamique"],LINES:["Lignes"],MACRO:["Macro"],DEPTH_OF_FIELD:["Faible profondeur de champ"],MINIMALIST:["Minimaliste"],PASTEL:["Pastel"],PATTERNS:["Motifs"],ROUND:["Rond"],SERENE:["Calme"],SYMMETRY:["Symétrie"],TEXTURES:["Textures"],TRIANGLES:["Triangles"],VINTAGE:["Vintage"],BOKEH:["Effet bokeh"],SEARCH_PHOTOS:["Rechercher des photos"],SEARCH_PEOPLE:["Rechercher des personnes"],SEARCH_GROUPS:["Recherchez des groupes"],EVERYONE:["Tout le monde"],SIGN_IN_BEFORE_SEARCH_TITLE:["Ce contenu est réservé à un public adulte."],SIGN_IN_BEFORE_SEARCH_MESSAGE:["Rejoignez Flickr pour désactiver le filtre SafeSearch."],SIGNUP_FOOTER_MESSAGE:["Gérez les photos de manière privée et trouvez l’inspiration dans la communauté."]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-photo-selector-photo-list-photo-interaction",function(e,a){var t=e.Template.Handlebars.revive({1:function(e,a,t,l,n){var s,o=e.escapeExpression;return'<a href="'+o(e.lambda(null!=(s=null!=(s=null!=a?a.photo:a)?s.owner:s)?s.url:s,a))+'" class="attribution">'+o((t.intlMessage||a&&a.intlMessage||t.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{user:null!=(s=null!=(s=null!=a?a.photo:a)?s.owner:s)?s.displayname:s,intlName:"common.BY_USER"},data:n}))+"</a>"},compiler:[7,">= 4.0.0"],main:function(e,a,t,l,n){var s,o,i=null!=a?a:{},r=e.escapeExpression;return'<div class="photo-list-photo-interaction">\n\t<div class="square"></div>\n\t<div class="interaction-bar">\n\t\t<div class="text">\n\t\t\t<a href="'+r("function"==typeof(o=null!=(o=t.photoPageUrl||(null!=a?a.photoPageUrl:a))?o:t.helperMissing)?o.call(i,{name:"photoPageUrl",hash:{},data:n}):o)+'" class="title">'+r(e.lambda(null!=(s=null!=a?a.photo:a)?s.title:s,a))+"</a>\n\t\t\t"+(null!=(s=t.if.call(i,null!=(s=null!=(s=null!=a?a.photo:a)?s.owner:s)?s.displayname:s,{name:"if",hash:{},fn:e.program(1,n,0),inverse:e.noop,data:n}))?s:"")+'\n\t\t</div>\n\t</div>\n</div>\n<div class="disabled-overlay"></div>\n'},useData:!0}),l={};e.Array.each([],function(a){var t=e.Template.get("hermes/"+a);t&&(l[a]=t)}),e.Template.register("hermes/photo-selector-photo-list-photo-interaction",function(a,n){return n=n||{},n.partials=n.partials?e.merge(l,n.partials):l,t(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});